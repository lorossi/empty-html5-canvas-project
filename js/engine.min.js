class Engine{constructor(t,s,e=60){this._canvas=t,this._ctx=s,this._fps=e,this._frameCount=0,this._actualFrameRate=0,this._noLoop=!1,this._then=null,this._setFps(this._fps),this._run()}_setFps(t){this._then=performance.now(),this._fps=t,this._fps_interval=1/this._fps}_run(){this.preload(),this.setup(),this._ctx.imageSmoothingQuality="high",this._timeDraw()}_timeDraw(){window.requestAnimationFrame(this._timeDraw.bind(this)),this._then||(this._then=performance.now());const t=performance.now(),s=t-this._then;s<this._fps_interval||this._noLoop||(this._ctx.save(),this.draw(),this._ctx.restore(),this._frameCount++,this._then=t-s%this._fps_interval,this._actualFrameRate=1/s)}_calculatePressCoords(t){const s=this._canvas.getBoundingClientRect(),e=Math.min(s.width,s.height)/this._canvas.getAttribute("width");if("touches"in t){if(t.touches.length>0){const i=(t.touches[0].pageX-s.left)/e,h=(t.touches[0].pageY-s.top)/e;return new Point(i,h)}return new Point(-1,-1)}{const i=(t.pageX-s.left)/e,h=(t.pageY-s.top)/e;return new Point(i,h)}}loop(){this._noLoop=!1}noLoop(){this._noLoop=!0}_clickCallback(t){const s=this._calculatePressCoords(t);this.click(s.x,s.y)}_mouseDownCallback(t){this._mouse_pressed=!0;const s=this._calculatePressCoords(t);this.mouseDown(s.x,s.y)}_mouseUpCallback(t){this._mouse_pressed=!1;const s=this._calculatePressCoords(t);this.mouseUp(s.x,s.y)}_mouseMoveCallback(t){const s=this._calculatePressCoords(t);this._mouse_pressed?this.mouseDragged(s.x,s.y):this.mouseMoved(s.x,s.y)}_keyDownCallback(t){this.keyDown(t.key,t.keyCode)}_keyUpCallback(t){this.keyUp(t.key,t.keyCode)}_keyPressCallback(t){this.keyPress(t.key,t.keyCode)}click(t,s){}mouseDown(t,s){}mouseDragged(t,s){}mouseUp(t,s){}mouseMoved(t,s){}keyPress(t,s){}keyDown(t,s){}keyUp(t,s){}saveFrame(t){let s;void 0===t&&(t="frame-"+this._frameCount.toString().padStart(6,0)),s=document.createElement("a"),s.download=t+".png",s.href=this._canvas.toDataURL("image/png"),document.body.appendChild(s),s.click(),document.body.removeChild(s)}background(t){this._ctx.save(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._ctx.fillStyle=t,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height),this._ctx.restore()}preload(){}setup(){}draw(){}get ctx(){return this._ctx}get canvas(){return this._canvas}get frameCount(){return this._frameCount}get frameRate(){return this._actualFrameRate}set frameRate(t){this._setFps(t)}get width(){return this._canvas.width}get height(){return this._canvas.height}}document.addEventListener("DOMContentLoaded",()=>{let t,s,e;t=document.querySelector("#sketch"),t.getContext&&(s=t.getContext("2d",{alpha:!1}),e=new Sketch(t,s)),t.addEventListener("click",t=>e._clickCallback(t)),t.addEventListener("mousedown",t=>e._mouseDownCallback(t)),t.addEventListener("mouseup",t=>e._mouseUpCallback(t)),t.addEventListener("mousemove",t=>e._mouseMoveCallback(t)),t.addEventListener("touchstart",t=>e._mouseDownCallback(t),{passive:!0}),t.addEventListener("touchend",t=>e._mouseUpCallback(t),{passive:!0}),t.addEventListener("touchmove",t=>e._mouseMoveCallback(t),{passive:!0}),document.addEventListener("keypress",t=>e._keyPressCallback(t)),document.addEventListener("keydown",t=>e._keyDownCallback(t)),document.addEventListener("keyup",t=>e._keyUpCallback(t))});class Color{constructor(t=0,s=0,e=0,i=1,h=!0){h?(this._r=t,this._g=s,this._b=e,this._a=i,this._h=void 0,this._s=void 0,this._l=void 0,this._toHsl()):(this._h=t,this._s=s,this._l=e,this._a=i,this._r=void 0,this._g=void 0,this._b=void 0,this._toRgb())}fromHSL(t,s,e){this._h=t,this._s=s,this._l=e,this._toRgb()}fromRGB(t,s,e){this._r=t,this._g=s,this._b=e,this._toHsl()}_toHsl(){const t=this._r/255,s=this._g/255,e=this._b/255;let i,h,o=Math.max(t,s,e),a=Math.min(t,s,e),_=(o+a)/2;if(o==a)i=h=0;else{let r=o-a;switch(h=_>.5?r/(2-o-a):r/(o+a),o){case t:i=(s-e)/r+(s<e?6:0);break;case s:i=(e-t)/r+2;break;case e:i=(t-s)/r+4}i/=6}this._h=Math.floor(360*i),this._s=Math.floor(100*h),this._l=Math.floor(100*_)}_toRgb(){if(0==this._s)this._r=this._l,this._g=this._l,this._b=this._l;else{const t=(t,s,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(s-t)*e:e<.5?s:e<2/3?t+(s-t)*(2/3-e)*6:t),s=this._l/100,e=this._h/360,i=this._s/100;let h=s<.5?s*(1+i):s+i-s*i,o=2*s-h;this._r=Math.floor(255*t(o,h,e+1/3)),this._g=Math.floor(255*t(o,h,e)),this._b=Math.floor(255*t(o,h,e-1/3))}}_toHex(t){return t=Math.floor(t),t.toString(16).padStart(2,0).toUpperCase()}_toDec(t){return parseInt(t,16)}_clamp(t,s,e){return Math.min(Math.max(s,t),e)}_wrap(t,s,e){for(;t>e;)t-=e-s;for(;t<s;)t+=e-s;return t}set hex(t){this._r=this._toDec(t.slice(1,3)),this._g=this._toDec(t.slice(3,5)),this._b=this._toDec(t.slice(5,7));const s=parseInt(t.slice(7,9),16);isNaN(s)?this._a=1:this._a=s,this._toHsl()}get hex(){return`#${this._toHex(this._r)}${this._toHex(this._g)}${this._toHex(this._a)}`}get rgb(){return`rgb(${this._r}, ${this._g}, ${this._b})`}get rgba(){return`rgba(${this._r}, ${this._g}, ${this._b}, ${this._a})`}get hsl(){return`hsl(${this._h}, ${this._s}%, ${this._l}%)`}get hsla(){return`hsla(${this._h}, ${this._s}%, ${this._l}%, ${this._a})`}get r(){return this._r}set r(t){this._r=Math.floor(this._clamp(t,0,255)),this._toHsl()}get g(){return this._g}set g(t){this._g=Math.floor(this._clamp(t,0,255)),this._toHsl()}get b(){return this._b}set b(t){this._b=Math.floor(this._clamp(t,0,255)),this._toHsl()}get a(){return this._a}set a(t){this._a=this._clamp(t,0,1)}get h(){return this._h}set h(t){this._h=Math.floor(this._wrap(t,0,360)),this._toRgb()}get s(){return this._s}set s(t){this._s=Math.floor(this._clamp(t,0,100)),this._toRgb()}get l(){return this._l}set l(t){this._l=Math.floor(this._clamp(t,0,255)),this._toRgb()}get monochrome(){return this._r==this._g&&this._g==this._b&&this._r}set monochrome(t){this._r=t,this._g=t,this._b=t,this._toHsl()}}class Point{constructor(t,s){this._x=t,this._y=s}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}}